"use strict";(self["webpackChunkcreation_gallery"]=self["webpackChunkcreation_gallery"]||[]).push([[137],{53977:function(e,t,n){const i=n(62662),s={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},a=(0,i.createElementVNode)("path",{d:"M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zm0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1zm10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1zM13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1z",fill:"currentColor"},null,-1),r=[a];t.A=(0,i.defineComponent)({name:"DashboardRound",render:function(e,t){return(0,i.openBlock)(),(0,i.createElementBlock)("svg",s,r)}})},25855:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});n(53297);var i=n(58258),s=n(47199),a=n(17562),r=n(53977),o=n(64634),u=n(75030),l=n(68309),c=n(68625);let m,h,d,v,f,g;class p{constructor(e){const{url:t}=e;this.scene=(0,o.H7)();const n={minFilter:u.k6q,magFilter:u.k6q,stencilBuffer:!1},i=new u.Gu$(500,50,50);i.scale(-1,1,1);const s=new u.V9B({map:(new u.Tap).load(t)}),a=new u.eaF(i,s);this.scene.add(a),this.fbo=new u.nWS(h,d,n)}render(e=0,t=!1){t?(m.setRenderTarget(this.fbo),m.clear(),m.render(this.scene,v)):(m.setRenderTarget(null),m.render(this.scene,v)),f.update()}}function x(e){const t={transition:0,texture:void 0,useTexture:!1,transitionSpeed:.05,animate:!1};this.sceneFrom=e,this.sceneTo=void 0,this.scene=new u.Z58,this.scene.background=new u.Q1f(0),this.camera=new u.qUd(h/-2,h/2,d/2,d/-2,-10,10),this.material=new u.BKk({uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:0},threshold:{value:.1},useTexture:{value:!0},tMixTexture:{value:t.texture}},vertexShader:"\n    varying vec2 vUv;\n\t\t\tvoid main() {\n\t\t\t\tvUv = vec2( uv.x, uv.y );\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}\n    ",fragmentShader:"\n      uniform float mixRatio;\n\t\t\tuniform sampler2D tDiffuse1;\n\t\t\tuniform sampler2D tDiffuse2;\n\t\t\tuniform sampler2D tMixTexture;\n\t\t\tuniform bool useTexture;\n\t\t\tuniform float threshold;\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main() {\n\t\t\t\tvec4 texel1 = texture2D( tDiffuse1, vUv );\n\t\t\t\tvec4 texel2 = texture2D( tDiffuse2, vUv );\n\t\t\t\tif (useTexture==true) {\n\t\t\t\t\tvec4 transitionTexel = texture2D( tMixTexture, vUv );\n\t\t\t\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\t\t\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\t\t\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t\t\t\t} else {\n\t\t\t\t\tgl_FragColor = mix( texel2, texel1, mixRatio );\n\t\t\t\t}\n\t\t\t}\n    "});const n=new u.bdM(h,d);this.quad=new u.eaF(n,this.material),this.scene.add(this.quad),this.update=(e,n)=>{if(t.animate)return!1;const{texture:i,useTexture:s=!1,transitionSpeed:a=.05}=n;return this.sceneTo=e,t.transition=0,t.texture=i,t.transitionSpeed=a,t.useTexture=s,t.animate=!0,this.material.uniforms.tDiffuse1.value=this.sceneTo.fbo.texture,this.material.uniforms.tDiffuse2.value=this.sceneFrom.fbo.texture,this.material.uniforms.threshold.value=.1,this.material.uniforms.mixRatio.value=0,this.material.uniforms.tMixTexture.value=i,this.material.uniforms.useTexture.value=s,!0},this.render=()=>{0===t.transition?(0,o.C8)(this.sceneFrom)&&this.sceneFrom.render():t.transition>=1?((0,o.C8)(this.sceneTo)&&this.sceneTo.render(),t.animate=!1,setTimeout((()=>{this.sceneFrom=this.sceneTo,t.transition=0}),10)):((0,o.C8)(this.sceneFrom)&&this.sceneFrom.render(0,!0),(0,o.C8)(this.sceneTo)&&this.sceneTo.render(0,!0),m.setRenderTarget(null),m.clear(),m.render(this.scene,this.camera)),t.animate&&t.transition<=1&&(t.transition=t.transition+t.transitionSpeed,this.material.uniforms.mixRatio.value=t.transition)}}class w{constructor(){const e=document.getElementById("webgl-output");h=e.offsetWidth,d=e.offsetHeight,m=(0,o.Ki)(),v=(0,o.Gc)(new u.Pq0(0,500,2),100,1,2e4),f=new c.N(v,m.domElement),f.minDistance=5,f.maxDistance=20,f.enablePan=!1,f.enableDamping=!0,f.dampingFactor=.05,this.scene1=new p({url:"/images/panorama/simons_town_harbour.jpg"}),this.scene2=new p({url:"/images/panorama/sunset.jpg"}),this.scene3=new p({url:"/images/panorama/kandao3.jpg"}),this.scene4=new p({url:"/images/panorama/veranda.jpg"}),this.scene5=new p({url:"/images/panorama/train.jpg"}),this.textures=[];const t=new u.Tap;for(let n=0;n<6;n++)this.textures.push(t.load(`/images/textures/transition/transition${n+1}.png`));this.transitionParams={useTexture:!1,transition:0,transitionSpeed:.05,texture:this.textures[0],animate:!1},this.transition=new x(this.scene1),g=(0,o._f)(),g.add(this.transitionParams,"transitionSpeed",0,1).step(.01).name("过渡速度"),g.add(this.transitionParams,"useTexture").name("是否使用图案"),setTimeout((()=>{this.animateCamera()}),1500),this._resizeFn=this.resizeFn.bind(this),window.addEventListener("resize",this._resizeFn),this.render()}animateCamera(){new l.Ay.Tween({y:500,fov:100,z:0}).to({y:0,fov:70,z:-200},4e3).onComplete((()=>{console.log("1")})).onUpdate((e=>{v.position.y=e.y,v.updateProjectionMatrix(),v.fov=e.fov,v.lookAt(new u.Pq0(0,0,e.z))})).start()}changeScene(e){let t;0===e?t=this.scene1:1===e?t=this.scene2:2===e?t=this.scene3:3===e?t=this.scene4:4===e&&(t=this.scene5),(0,o.C8)(t)&&(this.transitionParams.texture=this.textures[parseInt(6*Math.random())],this.transition.update(t,this.transitionParams))}resizeFn(){m.setSize(window.innerWidth,window.innerHeight),v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix()}render(){l.Ay.update(),this.transition.render(),requestAnimationFrame(this.render.bind(this))}beforeDestroy(){g&&g.destroy(),window.removeEventListener("resize",this._resizeFn)}}const b=new Map;let T;function k(e,t){console.log(t.arg,"arg");let n=[];return Array.isArray(t.arg)?n=t.arg:n.push(t.arg),function(i,s){const a=t.instance.popperRef,r=i.target,o=s.target,u=!t||!t.instance,l=!r||!o,c=e.contains(r)||e.contains(o),m=e===r,h=n.length&&n.some((e=>e?.contains(r)))||n.length&&n.includes(o),d=a&&(a.contains(r)||a.contains(o));u||l||c||m||h||d||t.value()}}(0,o.on)(document,"mousedown",(e=>T=e)),(0,o.on)(document,"mouseup",(e=>{for(const{documentHandler:t}of b.values())t(e,T)}));const C={beforeMount(e,t){b.set(e,{documentHandler:k(e,t),bindingFn:t.value})},updated(e,t){b.set(e,{documentHandler:k(e,t),bindingFn:t.value})},unmounted(e){b.delete(e)}};var F=C;const y=e=>((0,i.Qi)("data-v-6f216736"),e=e(),(0,i.jt)(),e),D={class:"relative"},R=y((()=>(0,i.Lk)("div",{id:"webgl-output"},null,-1))),_={class:"flex justify-center items-center"},z=y((()=>(0,i.Lk)("div",null,"选择场景",-1))),M=["onClick"],S=["src"],P={class:"scene-item_desc"},j={name:"PanoramaMulti"};var E=Object.assign(j,{setup(e){const t=(0,a.KR)([{name:"滨海",image:"/images/panorama/thumb/thumb1.png"},{name:"日落",image:"/images/panorama/thumb/thumb2.png"},{name:"巨石",image:"/images/panorama/thumb/thumb3.png"},{name:"走廊",image:"/images/panorama/thumb/thumb4.png"},{name:"火车",image:"/images/panorama/thumb/thumb5.png"}]),n=(0,a.KR)(0),u=(0,a.KR)(!1);let l;const c=()=>{u.value=!u.value},m=()=>{u.value=!1},h=(e,t)=>{t!==n.value&&(n.value=t,(0,o.C8)(l)&&l.changeScene(t))},d=(0,a.KR)([]);return(0,i.sV)((()=>{d.value.push(document.querySelector(".select-scene")),l=new w})),(0,i.xo)((()=>{l&&l.beforeDestroy()})),(e,o)=>{const l=(0,i.g2)("n-icon");return(0,i.uX)(),(0,i.CE)("div",D,[R,(0,i.Lk)("div",{class:(0,s.C4)(["select-scene"]),onClick:c},[(0,i.Lk)("div",_,[(0,i.bF)(l,{size:"30"},{default:(0,i.k6)((()=>[(0,i.bF)((0,a.R1)(r.A))])),_:1})]),z]),(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:(0,s.C4)(["scene-list_box",u.value?"show":""])},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.value,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,s.C4)(["scene-item",(n.value,"")]),key:t,onClick:n=>h(e,t)},[(0,i.Lk)("img",{src:e.image,alt:""},null,8,S),(0,i.Lk)("div",P,(0,s.v_)(e.name),1)],10,M)))),128))],2)),[[(0,a.R1)(F),m,d.value]])])}}}),q=n(20541);const A=(0,q.A)(E,[["__scopeId","data-v-6f216736"]]);var H=A}}]);