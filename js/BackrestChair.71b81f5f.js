"use strict";(self["webpackChunkcreation_gallery"]=self["webpackChunkcreation_gallery"]||[]).push([[895],{21815:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var s=a(58258),i=a(17562),r=a(34056),o=a(63019),h=a(69694),n=a(64634),d=a(75030),c=a(37949);class l{constructor(e){const{progress:t=n.lQ,complete:a=n.lQ}=e;this.isAutoRotate=!1,this.scene=(0,h.H7)(),this.scene.background=new d.Q1f(16777215),this.camera=(0,h.Gc)(new d.Pq0(26,26,26),55,1,2e4),this.initGui(),this.renderer=(0,h.Ki)(void 0,!0,2),this.renderer.setClearColor(16777215),this.renderer.autoClear=!1,this.controls=(0,h.ZN)(this.camera,this.renderer,!1),this.clock=(0,h.$i)();const s=new d.KPJ;this.objLoader=new c.L(s),this.textureLoader=new d.Tap(s),this.cubeLoader=new d.ScU(s),this.initLight(),this.loadAssets(),s.onProgress=(e,a,s)=>{t((0,n.tM)(a,s))},s.onError=()=>{},s.onLoad=()=>{a(),this.initMesh()},this._resizeFn=this.resizeFn.bind(this),window.addEventListener("resize",this._resizeFn),this.render()}loadAssets(){this.envMap=this.cubeLoader.load(["/models/backrest-chair/posx.jpg","/models/backrest-chair/negx.jpg","/models/backrest-chair/posy.jpg","/models/backrest-chair/negy.jpg","/models/backrest-chair/posz.jpg","/models/backrest-chair/negz.jpg"]),this.textureLoader.load("/models/backrest-chair/fabric_blue.jpg",(e=>{(0,n.J)(e,d.GJx,[2,2]),this.fabricBlue=e})),this.textureLoader.load("/models/backrest-chair/fabric_yellow.jpg",(e=>{(0,n.J)(e,d.GJx,[2,2]),this.fabricYellow=e})),this.textureLoader.load("/models/backrest-chair/fabric_blueBump.jpg",(e=>{(0,n.J)(e,d.GJx,[2,2]),this.fabricBlueBump=e})),this.textureLoader.load("/models/backrest-chair/wood_cherry.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodCherry=e})),this.textureLoader.load("/models/backrest-chair/wood_cherryBump.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodCherryBump=e})),this.textureLoader.load("/models/backrest-chair/wood_black.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodBlack=e})),this.textureLoader.load("/models/backrest-chair/wood_blackBump.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodBlackBump=e})),this.textureLoader.load("/models/backrest-chair/wood_hemlock.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodhemlock=e})),this.textureLoader.load("/models/backrest-chair/wood_hemlockBump.jpg",(e=>{(0,n.J)(e,d.GJx,[4,4]),this.woodhemlockBump=e})),this.textureLoader.load("/models/backrest-chair/cushionLightMap.jpg",(e=>{e.needsUpdate=!0,this.cushionLightMap=e})),this.textureLoader.load("/models/backrest-chair/backrestLightMap.jpg",(e=>{e.needsUpdate=!0,this.backrestLightMap=e})),this.textureLoader.load("/models/backrest-chair/frameLightMap.jpg",(e=>{e.needsUpdate=!0,this.frameLightMap=e})),this.objLoader.load("/models/backrest-chair/cushion.obj",(e=>{this.cushionObj=e})),this.objLoader.load("/models/backrest-chair/backrest.obj",(e=>{this.backrestObj=e})),this.objLoader.load("/models/backrest-chair/frame.obj",(e=>{this.frameObj=e}))}initGui(){this.gui=(0,h._f)();const e=this,t={yellow(){e.cushionObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.fabricYellow,t.material.needsUpdate=!0)})),e.backrestObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.fabricYellow,t.material.needsUpdate=!0)}))},blue(){e.cushionObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.fabricBlue,t.material.needsUpdate=!0)})),e.backrestObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.fabricBlue,t.material.needsUpdate=!0)}))},cherry(){e.frameObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.woodCherry,t.material.woodCherry=e.woodCherryBump,t.material.needsUpdate=!0)}))},black(){e.frameObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.woodBlack,t.material.woodCherry=e.woodBlackBump,t.material.needsUpdate=!0)}))},hemlock(){e.frameObj.traverse((t=>{t instanceof d.eaF&&(t.material.map=e.woodhemlock,t.material.woodCherry=e.woodhemlockBump,t.material.needsUpdate=!0)}))}},a=this.gui.addFolder("织物材质");a.add(t,"blue"),a.add(t,"yellow");const s=this.gui.addFolder("木头材质");s.add(t,"cherry"),s.add(t,"black")}initLight(){const e=new d.$p8(16777215,1);this.scene.add(e);const t=new d.nCl(16777215);t.position.set(-30,30,30),t.castShadow=!0,t.distance=100,this.scene.add(t)}initMesh(){const e=new d.B69;this.cushionObj.traverse((e=>{e instanceof d.eaF&&(e.material=new d._4j({map:this.fabricBlue,roughness:.94,metalness:.45,bumpMap:this.fabricBlueBump,bumpScale:.06,lightMap:this.cushionLightMap,lightMapIntensity:1,blending:d.NTi,envMap:this.envMap}),e.receiveShadow=!0,e.castShadow=!0)})),this.cushionObj.position.y=-10,e.add(this.cushionObj),this.backrestObj.traverse((e=>{e instanceof d.eaF&&(e.material=new d._4j({map:this.fabricBlue,roughness:.94,metalness:.45,bumpMap:this.fabricBlueBump,bumpScale:.06,lightMap:this.backrestLightMap,lightMapIntensity:1,blending:d.NTi,envMap:this.envMap}),e.receiveShadow=!0,e.castShadow=!0)})),this.backrestObj.position.y=-10,e.add(this.backrestObj),this.frameObj.traverse((e=>{e instanceof d.eaF&&(e.material=new d._4j({map:this.woodCherry,roughness:.75,metalness:.3,bumpMap:this.woodCherryBump,bumpScale:.05,lightMap:this.frameLightMap,lightMapIntensity:1,blending:d.NTi,envMap:this.envMap}),e.receiveShadow=!0,e.castShadow=!0)})),this.frameObj.position.y=-10,e.add(this.frameObj),this.scene.add(e)}autoRotate(){this.isAutoRotate=!this.isAutoRotate,this.controls.autoRotate=this.isAutoRotate}resizeFn(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}render(){this.renderer.render(this.scene,this.camera),this.controls.update(),this.timer=requestAnimationFrame(this.render.bind(this))}beforeDestroy(){this.timer&&cancelAnimationFrame(this.timer),this.gui.destroy(),window.addEventListener("resize",this._resizeFn)}}const m={class:"relative"},p=(0,s.Lk)("div",{id:"webgl-output",class:"webgl-output"},null,-1),u={name:"BackrestChair"};var b=Object.assign(u,{setup(e){let t=null;const a=(0,i.KR)(!0),h=(0,i.KR)(0);(0,s.sV)((()=>{t=new l({progress(e){h.value=e},complete(){a.value=!1}})})),(0,s.xo)((()=>{t&&t.beforeDestroy()}));const n=()=>{t&&t.autoRotate()};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",m,[p,a.value?((0,s.uX)(),(0,s.Wv)((0,i.R1)(r.X),{key:0,progress:h.value,animation:"Stretch"},null,8,["progress"])):(0,s.Q3)("",!0),(0,s.bF)((0,i.R1)(o.mQ),null,{default:(0,s.k6)((()=>[(0,s.bF)((0,i.R1)(o.yB),{class:"mr-4",onClick:n}),(0,s.bF)((0,i.R1)(o.oZ))])),_:1})]))}});const w=b;var g=w}}]);